#!/usr/bin/env python

'''
GOAL:
* create a set of galaxies with a range of stellar mass and sSFR relative to MS
* evolve galaxies from some epoch tmax to the present
* evolve SFRs according to MS evolution given in Whitaker+2012
* evolve stellar mass based on SFR evolution and mass loss as describe in Poggianti+2013

INPUT:
* tmax
* number of time steps
* number of mass bins
* number of sSFR bins


OUTPUT: 
* table containing
  |----------|-------|-----|--------|-------|
  |lookbackt | Mstar | SFR |Mstar_0 | SFR_0 |
  |----------|-------|-----|--------|-------|
* this allows someone to link a galaxy with a particular stellar mass and SFR to its progenitor at t = lookbackt




'''

#######################################
### IMPORTS
#######################################

import numpy as np
from astropy.table import Table

#######################################
### FUNCTIONS
#######################################

def get_fraction_mass_retained(t):
    ''' 
    use Poggianti+2013 relation to determine fraction of mass retained  

    INPUT:
    * time in yr since the birth of the stellar pop

    RETURNS:
    * fraction of the mass that is retained after mass loss

    '''

    return 1.749 - 0.124*np.log10(t)
    pass


def get_whitaker_ms(logMstar,z):
    ''' 
    get logSFR of main sequence galaxy of mass logMstar at redshift z   

    INPUT:
    * logMstar : log10 of stellar mass (in Msun)
    * z : redshift to calculate SFR for

    RETURNS:
    * logSFR : log10 of SFR in Msun/yr

    '''

    alpha = 0.70-0.13*z
    beta = 0.38 + 1.14*z - 0.19*z**2
    logSFR = alpha*(logMstar - 10.5) + beta
    return logSFR
